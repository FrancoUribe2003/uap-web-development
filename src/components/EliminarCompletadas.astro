<form method="post" action="/api/eliminarCompletadas" class="delete-form">
  <button type="submit" class="eliminar" id="clear">
    Eliminar todas las tareas completadas
  </button>
</form>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const btnEliminar = document?.querySelector("#clear");

    btnEliminar?.addEventListener("click", async (e) => {
      e.preventDefault(); // evitar recarga de pÃ¡gina

      const respuesta = await fetch("/api/eliminarCompletadas", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
      });

      if (respuesta.ok) {
        // Eliminar del DOM las tareas marcadas como completadas
        document.querySelectorAll(".task").forEach((task) => {
          const checkbox = task.querySelector(".checkmark") as HTMLInputElement;
          if (checkbox?.checked) {
            task.remove();
          }
        });
      } else {
        alert("No se pudieron eliminar las tareas completadas.");
      }
    });
  });
</script>